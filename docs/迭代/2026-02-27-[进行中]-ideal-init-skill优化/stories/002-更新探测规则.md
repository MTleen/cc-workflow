---
story_id: 002
title: 更新探测规则
status: pending
depends_on: [001]
---

# Story 002: 更新探测规则

## 上下文

### 需求来源
> 来源：P1-需求文档.md#三、重构方案 > 3.4.2 Step 2: 项目探测

**探测项**：

| 探测项 | 检测方式 | 默认值 |
|--------|----------|--------|
| 项目名称 | package.json.name → Git URL → 目录名 | 目录名 |
| 语言类型 | 特征文件检测 | Other |
| 框架 | 依赖分析 | - |
| Git 状态 | .git 目录检测 | false |
| 主分支 | git rev-parse | main |
| 测试命令 | 推断或读取配置 | - |
| 构建命令 | 推断或读取配置 | - |

**特征文件映射**：

| 特征文件 | 语言 | 测试命令 | 构建命令 |
|----------|------|----------|----------|
| `package.json` | Node.js | `npm test` | `npm run build` |
| `requirements.txt` / `pyproject.toml` | Python | `pytest` | - |
| `go.mod` | Go | `go test ./...` | `go build` |
| `pom.xml` / `build.gradle` | Java | `mvn test` | `mvn package` |

### 技术方案
> 来源：P3-技术方案.md#M2: 项目探测

**输入**：项目根目录路径

**输出**：探测结果对象（DetectionResult）

### 相关代码

- `.claude/skills/ideal-init/references/detection-rules.md` - 待更新的文件

## 任务清单

- [ ] 任务 1: 读取现有 detection-rules.md
- [ ] 任务 2: 更新特征文件映射表
  - [ ] 添加 Node.js 探测规则
  - [ ] 添加 Python 探测规则
  - [ ] 添加 Go 探测规则
  - [ ] 添加 Java 探测规则
- [ ] 任务 3: 添加默认值定义
- [ ] 任务 4: 添加探测失败处理策略
- [ ] 任务 5: 添加包管理器检测规则

## 验收标准

### 功能验收
- [ ] 包含 4 种语言的探测规则
- [ ] 每种语言有明确的测试/构建命令推断逻辑
- [ ] 定义了所有探测项的默认值
- [ ] 定义了探测失败的处理策略

### 代码质量
- [ ] Markdown 格式正确
- [ ] 表格对齐
- [ ] 术语使用一致

## 实现笔记

<!-- 由 Claude 在执行过程中填写 -->
