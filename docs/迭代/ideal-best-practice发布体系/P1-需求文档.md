---
需求名称: ideal-best-practice 发布体系构建
需求类型: software-feature
创建时间: 2026-02-21
当前阶段: P1
风险等级: 中
---

# P1-需求文档：ideal-best-practice 发布体系构建

## 一、需求背景

### 1.1 现状分析

当前 `cc-workflow` 项目已完成 Claude Code 中心化团队工作流的核心开发，包含：

1. **Agent 层**：6 个角色定义（pm、analyst、architect、dev、qa、tech-writer）
2. **Skill 层**：9 个流程规范（ideal-requirement、ideal-dev-solution 等）
3. **文档体系**：16 阶段流程文档、迭代记录、Wiki 文档

然而，项目存在以下发布层面的问题：

- 用户需手动复制 `.claude/` 目录内容，安装体验差
- 缺乏统一的包管理机制，无法追踪版本和依赖
- 无产品化展示入口，用户难以快速了解产品价值
- 安装脚本仅支持 Unix 系统，Windows 用户无法使用
- 未来产品线扩展时，缺乏命名空间隔离机制

### 1.2 问题陈述

当前工作流项目缺少标准化发布机制，导致以下问题：

1. **安装门槛高**：用户需手动操作文件系统，易出错且耗时
2. **版本管理缺失**：无法追踪已安装版本，升级困难
3. **跨平台兼容性不足**：Windows 用户无法便捷安装
4. **产品展示空白**：缺乏面向用户的展示页面和在线文档预览
5. **扩展性受限**：未来新增产品线时，缺乏统一的命名和管理规范

上述问题严重影响产品在企业内部的推广和复用。

### 1.3 目标概述

构建企业级最佳实践发布仓库 `ideal-best-practice`，实现以下目标：

1. 提供跨平台一键安装能力（macOS、Linux、Windows）
2. 建立标准化的包元数据和注册表机制
3. 构建产品展示网页，支持 skills/agents 在线预览
4. 为未来产品线扩展提供统一的发布框架

---

## 二、目标用户

| 用户角色 | 使用场景 | 核心需求 |
|----------|----------|----------|
| 企业开发者（macOS/Linux） | 日常开发工作流使用 | 一键安装、快速升级 |
| 企业开发者（Windows） | 日常开发工作流使用 | PowerShell 一键安装 |
| 技术管理者 | 评估和推广最佳实践 | 产品网页了解功能、在线预览 skills |
| 运维人员 | 批量部署到团队环境 | 离线安装包、版本控制 |
| 未来产品开发者 | 发布新的最佳实践产品 | 标准化发布流程、命名空间隔离 |

---

## 三、功能需求

### 3.1 功能清单

| 功能编号 | 功能名称 | 功能描述 | 优先级 |
|----------|----------|----------|--------|
| F001 | 发布仓库结构 | 定义 packages/、registry.json、site/ 标准目录结构 | P0 |
| F002 | manifest.json 包元数据 | 定义包名称、版本、前缀、依赖、描述等元数据 | P0 |
| F003 | registry.json 包注册表 | 索引所有可用包，包含版本列表和下载地址 | P0 |
| F004 | install.sh 安装脚本 | Unix 系统一键安装，支持指定包名和版本 | P0 |
| F005 | install.ps1 安装脚本 | Windows 系统一键安装，功能同上 | P0 |
| F006 | 产品展示网页 | 单页应用，展示产品特性、skills/agents 列表 | P0 |
| F007 | 在线预览功能 | 动态加载并展示 SKILL.md / AGENT.md 内容 | P0 |
| F008 | 发布脚本 | 当前仓库用，自动打包并推送到发布仓库 | P0 |
| F009 | 版本管理 | 支持语义化版本，支持指定版本安装 | P1 |
| F010 | 离线安装包 | 生成可离线使用的压缩包 | P1 |

### 3.2 功能详细说明

#### F001 发布仓库结构

```
ideal-best-practice/
├── registry.json              # 包注册表
├── packages/
│   └── ideal-dev/             # 产品线：开发工作流
│       ├── manifest.json      # 包元数据
│       ├── skills/            # Skill 定义文件
│       │   ├── ideal-requirement/
│       │   │   ├── SKILL.md
│       │   │   ├── scripts/
│       │   │   └── references/
│       │   └── ...
│       └── agents/            # Agent 定义文件
│           ├── pm.md
│           ├── architect.md
│           └── ...
│
├── install.sh                 # Unix 安装脚本
├── install.ps1                # Windows 安装脚本
│
└── site/                      # 产品展示网页
    ├── index.html
    ├── css/style.css
    ├── js/app.js
    └── assets/
```

#### F002 manifest.json 结构

```json
{
  "name": "ideal-dev",
  "version": "1.0.0",
  "prefix": "ideal-dev",
  "description": "Ideal 企业 Claude Code 开发工作流最佳实践",
  "author": "Ideal",
  "skills": [
    {
      "name": "requirement",
      "fullName": "ideal-dev:requirement",
      "path": "skills/ideal-requirement/SKILL.md",
      "description": "需求编写流程规范",
      "agents": ["pm", "analyst"]
    }
  ],
  "agents": [
    {
      "name": "pm",
      "path": "agents/pm.md",
      "description": "产品经理角色定义"
    }
  ],
  "dependencies": {},
  "compatibility": {
    "claudeCode": ">=1.0.0"
  }
}
```

#### F003 registry.json 结构

```json
{
  "version": "1.0.0",
  "updated": "2026-02-21",
  "packages": [
    {
      "name": "ideal-dev",
      "displayName": "Ideal 开发工作流",
      "description": "16 阶段全流程自动化工作流",
      "latestVersion": "1.0.0",
      "versions": ["1.0.0"],
      "url": "packages/ideal-dev/"
    }
  ]
}
```

#### F004/F005 安装脚本功能

- 检测 Claude Code 是否已安装
- 从 registry.json 获取包信息
- 下载并安装到 `~/.claude/skills/` 和 `~/.claude/agents/`
- 支持指定包名：`install.sh ideal-dev`
- 支持指定版本：`install.sh ideal-dev@1.0.0`
- 安装完成后显示使用说明

#### F006/F007 产品展示网页

**页面结构：**

1. **Hero 区域**：产品名称、一句话描述、快速开始命令
2. **功能特性**：16 阶段流程图解、核心价值说明
3. **Skills 预览**：从 registry.json 动态渲染，卡片式展示
4. **Agents 预览**：角色列表，点击查看详细定义
5. **快速开始**：安装命令、使用示例、常见问题

**技术方案：**

- 纯静态实现（HTML + CSS + Vanilla JS）
- 通过 fetch 加载 registry.json 和各 SKILL.md
- GitHub Pages 托管

#### F008 发布脚本

位于当前开发仓库 `scripts/publish.sh`：

1. 读取 `.claude/skills/` 和 `.claude/agents/` 目录
2. 生成 manifest.json
3. 更新 registry.json
4. 复制文件到发布仓库
5. 执行 git push

---

## 四、非功能需求

| 维度 | 要求 |
|------|------|
| 性能 | 网页首屏加载时间 < 2 秒；安装脚本执行时间 < 30 秒 |
| 可用性 | 安装命令简洁易懂，提供清晰的错误提示和回滚机制 |
| 安全性 | 安装脚本需校验文件完整性；禁止执行远程任意代码 |
| 兼容性 | 支持 macOS 10.15+、Ubuntu 18.04+、Windows 10+；Claude Code >= 1.0.0 |

---

## 五、约束条件

| 约束类型 | 说明 |
|----------|------|
| 技术约束 | 网页使用纯静态技术，不依赖 Node.js 构建；安装脚本使用 Shell 和 PowerShell |
| 平台约束 | 发布仓库托管于 GitHub，使用 GitHub Pages 托管网页 |
| 命名约束 | Skills 和 Agents 使用 `ideal-dev:` 前缀命名空间 |
| 维护约束 | 发布流程自动化，减少人工干预 |

---

## 六、验收标准

### 6.1 功能验收

- [ ] 发布仓库 `ideal-best-practice` 创建完成，目录结构符合规范
- [ ] `manifest.json` 包含 ideal-dev 包的完整元数据
- [ ] `registry.json` 正确索引 ideal-dev 包
- [ ] `install.sh` 在 macOS 和 Linux 上成功安装 ideal-dev 包
- [ ] `install.ps1` 在 Windows 10+ 上成功安装 ideal-dev 包
- [ ] 安装后可在 Claude Code 中调用 `ideal-dev:requirement` 等 skills
- [ ] 产品网页可在 GitHub Pages 正常访问
- [ ] 网页正确展示 skills 和 agents 列表
- [ ] 点击 skill/agent 可预览详细内容
- [ ] 发布脚本可自动打包并推送到发布仓库

### 6.2 非功能验收

- [ ] 网页首屏加载时间 < 2 秒（Chrome Lighthouse 测试）
- [ ] 安装脚本在无网络时给出明确错误提示
- [ ] 安装失败时自动清理已下载的文件
- [ ] 安装命令在 macOS、Linux、Windows 上表现一致

---

## 七、风险评估

| 风险项 | 影响程度 | 发生概率 | 应对措施 |
|--------|----------|----------|----------|
| GitHub 访问受限（国内网络） | 高 | 中 | 提供镜像下载地址；支持离线安装包 |
| Windows PowerShell 执行策略限制 | 中 | 中 | 在文档中提供执行策略设置说明 |
| skills/agents 命名冲突 | 中 | 低 | 使用 `ideal-dev:` 前缀隔离 |
| 网页加载 SKILL.md 失败（CORS） | 高 | 低 | 使用相对路径；GitHub Pages 无 CORS 限制 |
| 发布脚本同步遗漏文件 | 中 | 中 | 使用自动化检测，发布前校验完整性 |

---

## 八、参考资料

1. [Claude Code Skills 官方文档](https://docs.anthropic.com/claude-code/skills)
2. [GitHub Pages 静态站点托管](https://pages.github.com/)
3. [PowerShell 脚本最佳实践](https://docs.microsoft.com/powershell/scripting/learn/deep-dives/overview)
4. 当前项目 CLAUDE.md 和 README.md

---

*文档版本: v1.0*
*创建时间: 2026-02-21*
*作者: Claude Code*
