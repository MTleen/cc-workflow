---
需求名称: 流程阶段精简——删除上线阶段并新增成果提交阶段
创建时间: 2026-02-23
当前阶段: P7
---

# P7-测试用例：流程阶段精简——删除上线阶段并新增成果提交阶段

## 概述

本文档为「流程阶段精简」需求生成测试用例。由于这是一个**文档重构项目**，测试类型主要为**验证检查**，而非传统的代码测试。

### 测试范围

| 测试类型 | 适用性 | 说明 |
|----------|--------|------|
| 单元测试 | ⚠️ 部分 | 仅适用于 Python 脚本 |
| 集成测试 | ⚠️ 部分 | 流程状态流转测试 |
| 回归测试 | ✅ 主要 | 全局搜索验证无遗漏 |
| 性能测试 | ❌ 不适用 | 文档变更无性能影响 |

### 用例统计

| 类型 | 数量 | 占比 |
|------|------|------|
| 功能测试 | 12 | 55% |
| 边界测试 | 5 | 23% |
| 异常测试 | 5 | 23% |
| **总计** | **22** | **100%** |

---

## 一、功能测试用例

### TC-F-001: flow-state-spec.md 阶段定义更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-001 |
| **用例名称** | 验证 flow-state-spec.md 阶段定义正确更新 |
| **优先级** | P0 |
| **前置条件** | Story 001 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-flow-control/references/flow-state-spec.md`
2. 检查 `current_phase` 范围
3. 检查阶段映射表
4. 检查收尾阶段表格

**预期结果**:
- `current_phase` 范围为 `P1-P15`
- 阶段映射表包含 15 行定义
- 收尾阶段表格包含 3 行：P13 维基更新、P14 维基评审、P15 成果提交

---

### TC-F-002: CLAUDE.md 阶段描述更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-002 |
| **用例名称** | 验证 CLAUDE.md 阶段描述正确更新 |
| **优先级** | P0 |
| **前置条件** | Story 002 已完成 |

**测试步骤**:
1. 打开 `CLAUDE.md`
2. 检查阶段流程标题
3. 检查收尾阶段描述
4. 检查相关注释说明

**预期结果**:
- 标题显示 `15 阶段流程（P1-P15）`
- 收尾阶段描述为 P13-P15
- 注释说明与新的阶段编号一致

---

### TC-F-003: README.md 流程图更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-003 |
| **用例名称** | 验证 README.md 流程图正确更新 |
| **优先级** | P0 |
| **前置条件** | Story 002 已完成 |

**测试步骤**:
1. 打开 `README.md`
2. 检查 Mermaid 流程图
3. 检查阶段详情表格
4. 检查验证方式描述

**预期结果**:
- 流程图显示 15 个阶段节点
- 表格包含 15 行阶段定义
- 验证方式描述为 "P1 到 P15 走一遍"

---

### TC-F-004: ideal-wiki SKILL.md 阶段引用更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-004 |
| **用例名称** | 验证 ideal-wiki SKILL.md 阶段引用正确 |
| **优先级** | P0 |
| **前置条件** | Story 003 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-wiki/SKILL.md`
2. 搜索阶段引用
3. 确认阶段编号

**预期结果**:
- 维基更新阶段引用为 P13
- 无旧的 P15 引用（维基更新相关）

---

### TC-F-005: ideal-requirement SKILL.md 阶段引用更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-005 |
| **用例名称** | 验证 ideal-requirement SKILL.md 阶段引用正确 |
| **优先级** | P0 |
| **前置条件** | Story 003 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-requirement/SKILL.md`
2. 搜索阶段引用
3. 确认阶段编号

**预期结果**:
- 阶段引用与新编号一致
- 无旧的 P16 引用

---

### TC-F-006: ideal-init SKILL.md 阶段引用更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-006 |
| **用例名称** | 验证 ideal-init SKILL.md 阶段引用正确 |
| **优先级** | P0 |
| **前置条件** | Story 003 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-init/SKILL.md`
2. 搜索阶段引用
3. 确认阶段编号

**预期结果**:
- 阶段引用与新编号一致

---

### TC-F-007: flow-state.py 脚本更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-007 |
| **用例名称** | 验证 flow-state.py 脚本阶段逻辑正确 |
| **优先级** | P0 |
| **前置条件** | Story 004 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-flow-control/scripts/flow-state.py`
2. 检查 MAX_PHASE 值
3. 检查阶段判断逻辑
4. 检查收尾阶段列表

**预期结果**:
- `MAX_PHASE = 15`
- 阶段判断逻辑覆盖 P1-P15
- 收尾阶段列表为 P13-P15

---

### TC-F-008: generate-flow-status.py 脚本更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-008 |
| **用例名称** | 验证 generate-flow-status.py 生成的模板正确 |
| **优先级** | P0 |
| **前置条件** | Story 004 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-requirement/scripts/generate-flow-status.py`
2. 检查生成的阶段列表
3. 运行脚本测试

**预期结果**:
- 生成的模板包含 P1-P15 阶段列表
- 脚本执行无错误

---

### TC-F-009: flow-status.md.tmpl 模板更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-009 |
| **用例名称** | 验证流程状态模板正确 |
| **优先级** | P0 |
| **前置条件** | Story 004 已完成 |

**测试步骤**:
1. 打开 `.claude/skills/ideal-init/references/templates/flow-status.md.tmpl`
2. 检查阶段列表
3. 检查收尾阶段表格

**预期结果**:
- 模板包含 P1-P15 阶段列表
- 收尾阶段表格为 P13-P15

---

### TC-F-010: Wiki 流程概述文档更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-010 |
| **用例名称** | 验证 Wiki 流程概述文档阶段描述正确 |
| **优先级** | P1 |
| **前置条件** | Story 005 已完成 |

**测试步骤**:
1. 打开 `docs/Wiki/用户指南/流程概述.md`
2. 检查阶段流程图
3. 检查阶段描述表格

**预期结果**:
- 流程图显示 15 阶段
- 阶段描述表格与新编号一致

---

### TC-F-011: ideal-best-practice 同步

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-011 |
| **用例名称** | 验证 ideal-best-practice 与主仓库一致 |
| **优先级** | P1 |
| **前置条件** | Story 006 已完成 |

**测试步骤**:
1. 对比 `ideal-best-practice/packages/ideal-dev/skills/` 下的文件
2. 与主仓库 `.claude/skills/` 对应文件比较
3. 确认内容一致

**预期结果**:
- flow-state-spec.md 内容一致
- Skills 文档内容一致
- 脚本文件内容一致

---

### TC-F-012: P15 成果提交阶段定义完整

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-F-012 |
| **用例名称** | 验证 P15 成果提交阶段定义完整 |
| **优先级** | P0 |
| **前置条件** | Story 001 已完成 |

**测试步骤**:
1. 检查 flow-state-spec.md 中 P15 定义
2. 确认包含所有必要属性

**预期结果**:
- 阶段编号：P15
- 阶段名称：成果提交
- 执行者：Claude（自动执行）
- 触发条件：P14 维基评审通过
- 执行内容：合并代码、删除 worktree、提交 PR
- 输出：已合并的代码、已提交的 PR

---

## 二、边界测试用例

### TC-B-001: 全局搜索 P16 无遗漏

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-B-001 |
| **用例名称** | 验证全局无 P16 引用 |
| **优先级** | P0 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 执行命令：`grep -r "P16" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git`
2. 检查搜索结果

**预期结果**:
- 仅当前迭代文档（P1/P3/P5/P7）中出现 P16
- 其他文件无 P16 引用

---

### TC-B-002: 全局搜索 "16 阶段" 无遗漏

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-B-002 |
| **用例名称** | 验证全局无 "16 阶段" 引用 |
| **优先级** | P0 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 执行命令：`grep -r "16 阶段\|十六阶段" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git`
2. 检查搜索结果

**预期结果**:
- 无任何匹配结果

---

### TC-B-003: P15 引用仅与成果提交相关

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-B-003 |
| **用例名称** | 验证 P15 引用仅与成果提交相关 |
| **优先级** | P0 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 执行命令：`grep -r "P15" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git`
2. 检查每个匹配项的上下文

**预期结果**:
- 所有 P15 引用都与"成果提交"阶段相关
- 无旧的"维基更新"相关的 P15 引用

---

### TC-B-004: 流程状态模板生成边界

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-B-004 |
| **用例名称** | 验证流程状态模板生成包含完整阶段 |
| **优先级** | P1 |
| **前置条件** | Story 004 已完成 |

**测试步骤**:
1. 运行 `generate-flow-status.py` 生成测试模板
2. 检查生成的阶段列表

**预期结果**:
- 规划阶段：P1-P4
- 准备阶段：P5-P8
- 执行阶段：P9-P12
- 收尾阶段：P13-P15

---

### TC-B-005: 各阶段组边界正确

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-B-005 |
| **用例名称** | 验证各阶段组边界正确 |
| **优先级** | P1 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 检查 flow-state-spec.md
2. 确认阶段组划分

**预期结果**:
- 规划阶段：P1, P2, P3, P4
- 准备阶段：P5, P6, P7, P8
- 执行阶段：P9, P10, P11, P12
- 收尾阶段：P13, P14, P15

---

## 三、异常测试用例

### TC-E-001: 旧的流程状态文件兼容性

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-E-001 |
| **用例名称** | 验证旧的流程状态文件可正常处理 |
| **优先级** | P1 |
| **前置条件** | 存在旧的流程状态文件 |

**测试步骤**:
1. 找到旧的流程状态文件（包含 P13-P16）
2. 检查是否影响新功能

**预期结果**:
- 旧文件不影响新流程
- 或有明确的迁移指南

---

### TC-E-002: Mermaid 流程图语法正确

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-E-002 |
| **用例名称** | 验证 README.md 中 Mermaid 流程图语法正确 |
| **优先级** | P1 |
| **前置条件** | Story 002 已完成 |

**测试步骤**:
1. 复制 README.md 中的 Mermaid 代码
2. 在 Mermaid 在线编辑器中验证
3. 或使用 Markdown 预览工具检查

**预期结果**:
- 流程图可正确渲染
- 无语法错误

---

### TC-E-003: 表格格式正确

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-E-003 |
| **用例名称** | 验证所有表格格式正确 |
| **优先级** | P1 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 检查 flow-state-spec.md 中的表格
2. 检查 README.md 中的表格
3. 检查其他文档中的表格

**预期结果**:
- 所有表格列对齐正确
- 无格式错误

---

### TC-E-004: 脚本执行无错误

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-E-004 |
| **用例名称** | 验证 Python 脚本执行无错误 |
| **优先级** | P0 |
| **前置条件** | Story 004 已完成 |

**测试步骤**:
1. 执行 `python flow-state.py --help` 或类似命令
2. 执行 `python generate-flow-status.py --help` 或类似命令

**预期结果**:
- 脚本执行无语法错误
- 脚本输出符合预期

---

### TC-E-005: 无遗漏文件

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-E-005 |
| **用例名称** | 验证无遗漏的需要更新的文件 |
| **优先级** | P0 |
| **前置条件** | 所有 Story 已完成 |

**测试步骤**:
1. 执行命令：`grep -r "P13.*上线\|P14.*部署\|P15.*维基\|P16.*评审" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git`
2. 检查是否有遗漏

**预期结果**:
- 无旧的阶段编号与旧名称的组合

---

## 四、覆盖率报告

### 功能点覆盖

| 模块 | 功能点 | 用例数 | 覆盖率 |
|------|--------|--------|--------|
| M1 | flow-state-spec 更新 | 2 | 100% |
| M2 | CLAUDE.md 更新 | 1 | 100% |
| M3 | README.md 更新 | 1 | 100% |
| M4 | Skills 文档更新 | 3 | 100% |
| M5 | 脚本文件更新 | 2 | 100% |
| M6 | 模板文件更新 | 1 | 100% |
| M7 | Wiki 文档更新 | 1 | 100% |
| M8 | ideal-best-practice 同步 | 1 | 100% |
| M9 | 验证检查 | 3 | 100% |

### 验收标准覆盖

| 验收标准 | 对应用例 |
|----------|----------|
| 所有文件中 P13-P16 的引用已更新 | TC-B-001, TC-B-002, TC-B-003 |
| flow-state-spec.md 阶段定义更新 | TC-F-001, TC-F-012 |
| CLAUDE.md 阶段描述更新 | TC-F-002 |
| README.md 流程图和表格更新 | TC-F-003 |
| ideal-wiki SKILL.md 阶段引用更新 | TC-F-004 |
| Wiki 文档阶段引用更新 | TC-F-010 |
| 脚本文件阶段逻辑更新 | TC-F-007, TC-F-008 |
| P15 成果提交阶段定义完整 | TC-F-012 |

**总覆盖率**: 100%

---

## 五、测试执行清单

### 执行前准备

- [ ] 确认所有 Story 已完成
- [ ] 准备测试环境（终端、编辑器）
- [ ] 准备验证命令

### 执行顺序

| 顺序 | 用例编号 | 说明 |
|------|----------|------|
| 1 | TC-F-001 ~ TC-F-012 | 功能测试 |
| 2 | TC-B-001 ~ TC-B-005 | 边界测试 |
| 3 | TC-E-001 ~ TC-E-005 | 异常测试 |

### 验证命令汇总

```bash
# 检查 P16 引用
grep -r "P16" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git

# 检查 16 阶段引用
grep -r "16 阶段\|十六阶段" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git

# 检查 P15 引用
grep -r "P15" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git

# 检查旧的阶段名称组合
grep -r "P13.*上线\|P14.*部署\|P15.*维基\|P16.*评审" . --exclude-dir=node_modules --exclude-dir=build --exclude-dir=.git
```

---

*文档版本: v1.0*
*创建时间: 2026-02-23*
*作者: Claude Code*
