---
需求名称: ideal-cli 工作流初始化工具
关联计划: P5-编码计划.md
创建时间: 2026-02-23
当前阶段: P7
---

# P7-测试用例：ideal-cli 工作流初始化工具

## 一、测试概览

### 1.1 用例统计

| 类型 | 数量 | 占比 |
|------|------|------|
| 功能测试 | 28 | 56% |
| 边界测试 | 12 | 24% |
| 异常测试 | 10 | 20% |
| **总计** | **50** | **100%** |

### 1.2 覆盖率统计

| 功能模块 | 功能用例 | 边界用例 | 异常用例 | 覆盖率 |
|----------|----------|----------|----------|--------|
| F001 ideal init | 8 | 4 | 3 | 100% |
| F002 ideal config | 5 | 2 | 2 | 100% |
| F003 ideal update | 5 | 2 | 2 | 100% |
| F004 ideal doctor | 5 | 2 | 2 | 100% |
| F005 ideal --help | 3 | 1 | 1 | 100% |
| 非功能需求 | 2 | 1 | 0 | 100% |

---

## 二、功能测试用例

### 2.1 F001 ideal init

#### TC-FUNC-001: 首次初始化工作流

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-001 |
| **用例名称** | 首次初始化工作流 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录；3. 网络连接正常 |

**测试步骤**:
1. 执行 `ideal init`
2. 输入项目名称：my-project（或回车使用默认值）
3. 输入 Git 分支：main（或回车使用默认值）
4. 选择技术栈：Node.js
5. 是否创建示例文档：N

**预期结果**:
- 目录结构正确创建：`.claude/agents/`、`.claude/skills/`、`docs/迭代/`、`docs/Wiki/`
- 配置文件 `CLAUDE.md` 正确生成
- 配置文件 `.claude/project-config.md` 正确生成
- 输出成功提示和下一步指引

---

#### TC-FUNC-002: 使用默认值快速初始化

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-002 |
| **用例名称** | 使用默认值快速初始化 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录；3. 网络连接正常 |

**测试步骤**:
1. 执行 `ideal init`
2. 对所有提示直接按回车使用默认值

**预期结果**:
- 项目名称 = 当前目录名
- Git 分支 = main
- 技术栈 = Node.js
- 不创建示例文档
- 初始化成功完成

---

#### TC-FUNC-003: 跳过可选配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-003 |
| **用例名称** | 跳过可选配置项 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录 |

**测试步骤**:
1. 执行 `ideal init`
2. 输入项目名称后，对 Git 分支输入 `skip`

**预期结果**:
- Git 分支使用默认值 main
- 配置文件中 gitBranch 字段为 main
- 初始化成功完成

---

#### TC-FUNC-004: 已存在配置时覆盖确认

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-004 |
| **用例名称** | 已存在配置时覆盖确认 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已存在 `.claude/` 目录 |

**测试步骤**:
1. 执行 `ideal init`
2. 提示是否覆盖时选择 Yes

**预期结果**:
- 显示覆盖确认提示
- 确认后重新初始化
- 旧配置被覆盖

---

#### TC-FUNC-005: 已存在配置时取消操作

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-005 |
| **用例名称** | 已存在配置时取消操作 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已存在 `.claude/` 目录 |

**测试步骤**:
1. 执行 `ideal init`
2. 提示是否覆盖时选择 No

**预期结果**:
- 显示覆盖确认提示
- 取消后退出初始化
- 原有配置保持不变

---

#### TC-FUNC-006: 模板变量正确替换

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-006 |
| **用例名称** | 模板变量正确替换 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录 |

**测试步骤**:
1. 执行 `ideal init`，项目名称输入 test-project
2. 完成初始化
3. 查看 `CLAUDE.md` 和 `project-config.md` 内容

**预期结果**:
- `{{projectName}}` 被替换为 test-project
- `{{gitBranch}}` 被替换为 main
- `{{initializedAt}}` 被替换为当前日期
- 无残留模板变量

---

#### TC-FUNC-007: 元数据文件正确生成

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-007 |
| **用例名称** | 元数据文件正确生成 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录 |

**测试步骤**:
1. 执行 `ideal init` 完成初始化
2. 查看 `.claude/.metadata.json` 文件

**预期结果**:
- 文件存在且格式正确
- 包含 version 字段
- 包含 initializedAt 时间戳
- 包含 templateVersion 字段
- 包含 files 哈希记录

---

#### TC-FUNC-008: 创建示例需求文档

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-008 |
| **用例名称** | 创建示例需求文档 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录为空项目目录 |

**测试步骤**:
1. 执行 `ideal init`
2. 是否创建示例文档选择 Y

**预期结果**:
- `docs/迭代/` 目录下存在示例需求文档
- 示例文档格式正确

---

### 2.2 F002 ideal config

#### TC-FUNC-009: 列出所有配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-009 |
| **用例名称** | 列出所有配置项 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config list`

**预期结果**:
- 输出所有配置项及其值
- 格式清晰易读（表格或列表）
- 包含 projectName、gitBranch、techStack 等字段

---

#### TC-FUNC-010: 获取单个配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-010 |
| **用例名称** | 获取单个配置项 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config get projectName`

**预期结果**:
- 输出项目名称的值
- 格式清晰

---

#### TC-FUNC-011: 获取嵌套配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-011 |
| **用例名称** | 获取嵌套配置项 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config get workflow.templateRepo`

**预期结果**:
- 输出嵌套配置项的值（ideal-lab）
- 支持点号分隔的嵌套路径

---

#### TC-FUNC-012: 设置配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-012 |
| **用例名称** | 设置配置项 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config set gitBranch develop`
2. 执行 `ideal config get gitBranch`

**预期结果**:
- 设置成功
- 获取时返回新值 develop

---

#### TC-FUNC-013: 设置嵌套配置项

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-013 |
| **用例名称** | 设置嵌套配置项 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config set workflow.lastUpdated 2026-02-24`
2. 执行 `ideal config get workflow.lastUpdated`

**预期结果**:
- 设置成功
- 获取时返回新值

---

### 2.3 F003 ideal update

#### TC-FUNC-014: 检查更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-014 |
| **用例名称** | 检查更新 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化；3. 网络连接正常 |

**测试步骤**:
1. 执行 `ideal update`
2. 远程版本与本地版本相同时

**预期结果**:
- 提示"已是最新版本"
- 不执行任何更新操作

---

#### TC-FUNC-015: 有更新时显示变更列表

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-015 |
| **用例名称** | 有更新时显示变更列表 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化；3. 远程有新版本 |

**测试步骤**:
1. 执行 `ideal update`
2. 远程版本高于本地版本

**预期结果**:
- 显示变更文件列表
- 显示版本差异
- 提示是否继续更新

---

#### TC-FUNC-016: 无冲突更新

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-016 |
| **用例名称** | 无冲突更新 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化；3. 远程有新版本；4. 本地文件未被修改 |

**测试步骤**:
1. 执行 `ideal update`
2. 确认继续更新

**预期结果**:
- 更新成功
- 文件内容更新为远程版本
- 元数据文件更新
- 输出更新摘要

---

#### TC-FUNC-017: 冲突时选择保留本地

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-017 |
| **用例名称** | 冲突时选择保留本地 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 本地有用户修改；3. 远程有新版本 |

**测试步骤**:
1. 修改 `.claude/agents/pm.md`
2. 执行 `ideal update`
3. 对冲突文件选择 keep（保留本地）

**预期结果**:
- 显示冲突检测提示
- 提供处理选项
- 选择 keep 后保留本地修改
- 其他无冲突文件正常更新

---

#### TC-FUNC-018: 冲突时选择覆盖

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-018 |
| **用例名称** | 冲突时选择覆盖 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 本地有用户修改；3. 远程有新版本 |

**测试步骤**:
1. 修改 `.claude/agents/pm.md`
2. 执行 `ideal update`
3. 对冲突文件选择 overwrite（覆盖）

**预期结果**:
- 显示冲突检测提示
- 选择 overwrite 后使用远程版本
- 本地修改被覆盖

---

### 2.4 F004 ideal doctor

#### TC-FUNC-019: 所有检查通过

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-019 |
| **用例名称** | 所有检查通过 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化；3. 环境配置正确 |

**测试步骤**:
1. 执行 `ideal doctor`

**预期结果**:
- 所有检查项显示 ✓
- 输出摘要：N 项通过，0 项警告，0 项错误
- 退出码为 0

---

#### TC-FUNC-020: 检测目录结构缺失

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-020 |
| **用例名称** | 检测目录结构缺失 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. .claude/agents/ 目录被删除 |

**测试步骤**:
1. 删除 `.claude/agents/` 目录
2. 执行 `ideal doctor`

**预期结果**:
- directory-structure 检查显示 ✗
- 提示缺失的目录
- 退出码为 1

---

#### TC-FUNC-021: 检测 Node.js 版本

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-021 |
| **用例名称** | 检测 Node.js 版本 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. Node.js 版本 >= 18 |

**测试步骤**:
1. 执行 `ideal doctor`

**预期结果**:
- node-version 检查显示版本信息
- 版本 >= 18 时显示 ✓
- 版本 < 18 时显示 ⚠ 或 ✗

---

#### TC-FUNC-022: 检测 Python 版本

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-022 |
| **用例名称** | 检测 Python 版本 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal doctor`

**预期结果**:
- python-version 检查显示版本信息
- 版本 >= 3.10 时显示 ✓
- 版本 < 3.10 时显示 ⚠（info 级别）

---

#### TC-FUNC-023: 摘要统计正确

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-023 |
| **用例名称** | 摘要统计正确 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 有部分检查未通过 |

**测试步骤**:
1. 制造一个警告（如低版本 Python）
2. 执行 `ideal doctor`

**预期结果**:
- 摘要统计通过/警告/错误数量正确
- 数量与实际检查结果一致

---

### 2.5 F005 ideal --help

#### TC-FUNC-024: 显示帮助信息

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-024 |
| **用例名称** | 显示帮助信息 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal --help`

**预期结果**:
- 显示程序名称和描述
- 显示所有可用命令（init, config, update, doctor）
- 显示选项说明（--version, --help）
- 格式清晰

---

#### TC-FUNC-025: 显示版本信息

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-025 |
| **用例名称** | 显示版本信息 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal --version`

**预期结果**:
- 输出版本号（如 1.0.0）
- 格式符合 semver 规范

---

#### TC-FUNC-026: 显示使用示例

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-026 |
| **用例名称** | 显示使用示例 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal --help`

**预期结果**:
- 帮助信息包含使用示例
- 示例包含常用命令（ideal init, ideal doctor 等）

---

### 2.6 非功能测试

#### TC-FUNC-027: 初始化性能

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-027 |
| **用例名称** | 初始化性能 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 网络连接正常 |

**测试步骤**:
1. 记录开始时间
2. 执行 `ideal init`（使用默认值）
3. 记录结束时间

**预期结果**:
- 执行时间不超过 30 秒
- 无明显卡顿

---

#### TC-FUNC-028: 跨平台兼容性

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-FUNC-028 |
| **用例名称** | 跨平台兼容性 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 在不同操作系统测试 |

**测试步骤**:
1. 在 macOS 上执行 `ideal init`
2. 在 Linux 上执行 `ideal init`
3. 在 Windows 上执行 `ideal init`

**预期结果**:
- 三个平台均正常工作
- 生成的文件路径正确
- 无平台特定错误

---

## 三、边界测试用例

### 3.1 输入边界

#### TC-EDGE-001: 项目名称边界

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-001 |
| **用例名称** | 项目名称边界 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal init`
2. 项目名称输入空字符串（直接回车）
3. 项目名称输入超长字符串（256+ 字符）
4. 项目名称输入特殊字符（中文、空格、符号）

**预期结果**:
- 空字符串使用默认值（当前目录名）
- 超长字符串正常处理或提示限制
- 特殊字符正常处理

---

#### TC-EDGE-002: 配置键名边界

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-002 |
| **用例名称** | 配置键名边界 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录已完成初始化 |

**测试步骤**:
1. 执行 `ideal config get`（不提供键名）
2. 执行 `ideal config get nonexistent.key`
3. 执行 `ideal config get` 超深层嵌套键

**预期结果**:
- 不提供键名时提示用法或列出所有
- 不存在的键返回空或提示不存在
- 超深层键正常处理

---

### 3.2 状态边界

#### TC-EDGE-003: 未初始化时执行命令

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-003 |
| **用例名称** | 未初始化时执行命令 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录未初始化 |

**测试步骤**:
1. 执行 `ideal config list`
2. 执行 `ideal update`
3. 执行 `ideal doctor`

**预期结果**:
- config 命令提示需要先初始化
- update 命令提示需要先初始化
- doctor 命令正常执行（检测到未初始化）

---

#### TC-EDGE-004: 空目录初始化

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-004 |
| **用例名称** | 空目录初始化 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录完全为空 |

**测试步骤**:
1. 在空目录执行 `ideal init`
2. 完成初始化

**预期结果**:
- 初始化成功
- 所有目录和文件正确创建

---

### 3.3 文件边界

#### TC-EDGE-005: 配置文件格式异常

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-005 |
| **用例名称** | 配置文件格式异常 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. project-config.md 格式被破坏 |

**测试步骤**:
1. 手动破坏 `.claude/project-config.md` 的 YAML frontmatter
2. 执行 `ideal config list`

**预期结果**:
- 检测到格式错误
- 提示配置文件损坏
- 提供修复建议

---

#### TC-EDGE-006: 元数据文件缺失

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-006 |
| **用例名称** | 元数据文件缺失 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. .metadata.json 被删除 |

**测试步骤**:
1. 删除 `.claude/.metadata.json`
2. 执行 `ideal update`

**预期结果**:
- 提示元数据缺失
- 建议重新初始化或提供修复选项

---

### 3.4 版本边界

#### TC-EDGE-007: CLI 版本与模板版本不兼容

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-007 |
| **用例名称** | CLI 版本与模板版本不兼容 |
| **优先级** | P1 |
| **前置条件** | 1. CLI 版本低于模板要求的最低版本 |

**测试步骤**:
1. 执行 `ideal init`
2. 远程模板 minCliVersion 高于当前 CLI 版本

**预期结果**:
- 检测到版本不兼容
- 提示需要升级 CLI
- 不执行初始化

---

### 3.5 网络边界

#### TC-EDGE-008: 大文件下载

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-008 |
| **用例名称** | 大文件下载 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 网络连接正常但较慢 |

**测试步骤**:
1. 执行 `ideal init`
2. 模板包含大量文件

**预期结果**:
- 显示进度提示
- 在超时时间内完成
- 或提示超时并提供重试选项

---

### 3.6 并发边界

#### TC-EDGE-009: 并发执行 init

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-009 |
| **用例名称** | 并发执行 init |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 同时在两个终端执行 `ideal init`

**预期结果**:
- 第二个进程检测到锁或已存在配置
- 提示冲突或等待

---

#### TC-EDGE-010: 更新过程中断

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-010 |
| **用例名称** | 更新过程中断 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 正在执行 update |

**测试步骤**:
1. 执行 `ideal update`
2. 在更新过程中按 Ctrl+C 中断

**预期结果**:
- 优雅退出
- 备份文件保留
- 可通过重新执行 update 恢复

---

#### TC-EDGE-011: 磁盘空间不足

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-011 |
| **用例名称** | 磁盘空间不足 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 磁盘空间接近满 |

**测试步骤**:
1. 模拟磁盘空间不足
2. 执行 `ideal init`

**预期结果**:
- 检测到磁盘空间不足
- 提示清晰错误信息
- 不产生部分写入的文件

---

#### TC-EDGE-012: 权限不足

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-EDGE-012 |
| **用例名称** | 权限不足 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 当前目录无写权限 |

**测试步骤**:
1. 在只读目录执行 `ideal init`

**预期结果**:
- 检测到权限问题
- 提示清晰错误信息
- 提供解决方案建议

---

## 四、异常测试用例

### 4.1 网络异常

#### TC-ERR-001: 离线环境初始化

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-001 |
| **用例名称** | 离线环境初始化 |
| **优先级** | P0 |
| **前置条件** | 1. 已安装 ideal-cli；2. 网络断开 |

**测试步骤**:
1. 断开网络连接
2. 执行 `ideal init`

**预期结果**:
- 显示明确的网络错误提示
- 提示需要网络连接
- 退出码非 0

---

#### TC-ERR-002: GitHub API 限流

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-002 |
| **用例名称** | GitHub API 限流 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. GitHub API 请求达到限制 |

**测试步骤**:
1. 模拟 GitHub API 403 响应
2. 执行 `ideal init`

**预期结果**:
- 检测到 API 限流
- 提示等待时间
- 建议使用认证或稍后重试

---

#### TC-ERR-003: 网络超时

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-003 |
| **用例名称** | 网络超时 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 网络延迟极高 |

**测试步骤**:
1. 模拟网络超时
2. 执行 `ideal init`

**预期结果**:
- 检测到超时
- 显示超时错误信息
- 提供重试建议

---

### 4.2 输入异常

#### TC-ERR-004: 无效命令

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-004 |
| **用例名称** | 无效命令 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal unknowncommand`

**预期结果**:
- 显示未知命令错误
- 显示可用命令列表
- 提示使用 --help

---

#### TC-ERR-005: 无效参数

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-005 |
| **用例名称** | 无效参数 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli |

**测试步骤**:
1. 执行 `ideal config set`（缺少参数）
2. 执行 `ideal config get`（缺少参数）

**预期结果**:
- 显示参数缺失错误
- 显示正确用法

---

### 4.3 文件系统异常

#### TC-ERR-006: 文件被锁定

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-006 |
| **用例名称** | 文件被锁定 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 配置文件被其他进程锁定 |

**测试步骤**:
1. 用其他进程锁定配置文件
2. 执行 `ideal config set gitBranch test`

**预期结果**:
- 检测到文件锁定
- 提示关闭占用进程
- 或提供重试选项

---

#### TC-ERR-007: 模板仓库不存在

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-007 |
| **用例名称** | 模板仓库不存在 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 配置的模板仓库不存在 |

**测试步骤**:
1. 修改配置指向不存在的仓库
2. 执行 `ideal init`

**预期结果**:
- 检测到仓库不存在（404）
- 显示清晰错误信息
- 建议检查配置

---

### 4.4 数据异常

#### TC-ERR-008: version.json 格式错误

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-008 |
| **用例名称** | version.json 格式错误 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 远程 version.json 格式错误 |

**测试步骤**:
1. 模拟返回格式错误的 version.json
2. 执行 `ideal update`

**预期结果**:
- 检测到格式错误
- 显示解析错误信息
- 建议联系维护者

---

#### TC-ERR-009: 哈希校验失败

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-009 |
| **用例名称** | 哈希校验失败 |
| **优先级** | P2 |
| **前置条件** | 1. 已安装 ideal-cli；2. 下载的文件哈希与预期不符 |

**测试步骤**:
1. 模拟文件下载损坏
2. 执行 `ideal init`

**预期结果**:
- 检测到哈希不匹配
- 提示下载可能损坏
- 建议重试

---

#### TC-ERR-010: 用户中断

| 项目 | 内容 |
|------|------|
| **用例编号** | TC-ERR-010 |
| **用例名称** | 用户中断 |
| **优先级** | P1 |
| **前置条件** | 1. 已安装 ideal-cli；2. 正在执行 init |

**测试步骤**:
1. 执行 `ideal init`
2. 在交互过程中按 Ctrl+C

**预期结果**:
- 优雅退出
- 不产生不完整的配置
- 显示已取消提示

---

## 五、测试执行计划

### 5.1 执行顺序

1. **Phase 1**: P0 功能测试（TC-FUNC-001 ~ TC-FUNC-026）
2. **Phase 2**: P0 边界和异常测试
3. **Phase 3**: P1 功能测试
4. **Phase 4**: P1 边界和异常测试
5. **Phase 5**: P2 测试

### 5.2 环境要求

| 环境 | 说明 |
|------|------|
| Node.js | 18.x, 20.x |
| 操作系统 | macOS, Linux (Ubuntu), Windows 10/11 |
| 网络 | 正常连接 + 离线模拟 |

---

*文档版本: v1.0*
*创建时间: 2026-02-23*
*作者: Claude Code*
