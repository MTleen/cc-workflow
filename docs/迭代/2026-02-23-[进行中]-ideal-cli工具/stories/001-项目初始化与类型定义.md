---
story_id: 001
title: 项目初始化与类型定义
status: completed
depends_on: []
---

# Story 001: 项目初始化与类型定义

## 上下文

### 需求来源
> 来源：P1-需求文档.md#三、功能需求

构建 `ideal-cli` 命令行工具，通过 npm 全局安装 (`npm install -g ideal-cli`)。

### 技术方案
> 来源：P3-技术方案.md#二、系统架构

- 运行时：Node.js 18+
- CLI 框架：Commander.js
- 测试框架：Vitest
- 构建工具：tsup
- TypeScript 配置

### 数据模型
> 来源：P3-技术方案.md#四、数据模型

```typescript
interface ProjectConfig {
  projectName: string;
  gitBranch: string;
  techStack: TechStack;
  workflow: {
    templateRepo: string;
    templateBranch: string;
    lastUpdated: string;
  };
  initializedAt: string;
}

interface TemplateMeta {
  version: string;
  releasedAt: string;
  changelog?: string;
  files: TemplateFile[];
}

interface DoctorResult {
  checks: CheckResult[];
  summary: {
    passed: number;
    warnings: number;
    errors: number;
  };
}
```

## 任务清单

- [x] M010-1: 初始化 npm 项目
  - [x] 创建 package.json
  - [x] 安装生产依赖
  - [x] 安装开发依赖
  - [x] 验证依赖安装
- [x] M010-2: 配置 TypeScript
  - [x] 创建 tsconfig.json
  - [x] 运行类型检查
- [x] M010-3: 配置 tsup 构建
  - [x] 创建 tsup.config.ts
  - [x] 添加 build 脚本
  - [x] 验证构建输出
- [x] M010-4: 配置 Vitest
  - [x] 创建 vitest.config.ts
  - [x] 添加 test 脚本
  - [x] 创建示例测试
- [x] M011-1: 定义配置类型
  - [x] 创建 src/types/config.ts
  - [x] 定义 ProjectConfig, TechStack
- [x] M011-2: 定义模板类型
  - [x] 创建 src/types/template.ts
  - [x] 定义 TemplateMeta, TemplateFile
- [x] M011-3: 定义诊断类型
  - [x] 创建 src/types/doctor.ts
  - [x] 定义 DoctorResult, CheckResult
  - [x] 创建 src/types/index.ts 导出

## 验收标准

### 功能验收
- [x] `npm install` 成功无错误
- [x] `npx tsc --noEmit` 通过无类型错误
- [x] `npm run build` 生成 dist/ 目录
- [x] `npm test` 运行测试通过

### 代码质量
- [x] 所有类型定义完整
- [x] 类型可正确导出和导入
- [x] 目录结构符合设计

## 实现笔记

**完成时间**: 2026-02-23

**已创建文件**:
- `package.json` - npm 项目配置，包含所有依赖
- `tsconfig.json` - TypeScript 配置，目标 ES2022
- `tsup.config.ts` - 构建配置，ESM 格式，带 shebang
- `vitest.config.ts` - 测试配置
- `tests/example.test.ts` - 示例测试
- `src/types/config.ts` - 项目配置类型
- `src/types/template.ts` - 模板元数据类型
- `src/types/doctor.ts` - 诊断结果类型
- `src/types/index.ts` - 类型导出入口
- `src/index.ts` - CLI 入口占位

**验证结果**:
- TypeScript 类型检查: ✅ 通过
- 构建: ✅ 成功生成 dist/
- 测试: ✅ 1 个测试通过
